<!DOCTYPE html>
<html lang="en" Theme="blue_material" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
  <title>Settings</title>
  <script src="../bridge/android.js"></script>
  <script src="../database/MainDataBase.js"></script>
  <script src="../langs/langs.js"></script>
  <link rel="stylesheet" href="../ui-files/ui.css">
  <link rel="stylesheet" href="../ui-files/font-usage.css">
  <link rel="stylesheet" href="../ui-files/variables.css">
  <link rel="stylesheet" href="../components/components.css">
  <link rel="stylesheet" href="../components/modal-ver.css">
  <link rel="stylesheet" href="../ripple-files/ripple.css">
  <link rel="stylesheet" href="../components/segment-btns.css">
  <script  src="bundle.js"></script>

  <script>
          if(localStorage.getItem('useLightTheme') && localStorage.getItem('useLightTheme') === 'true'){
        document.documentElement.setAttribute('colorTheme', 'light');
        }
  </script>
  <style>
        .activity-large-content::before {
            position: fixed;
            bottom: 0;
            content: '';
            width: 100%;
            background: linear-gradient(0deg, var(--Surface) 10%, rgba(255, 0, 0, 0));
            height: 30px;
            z-index: 1;
        }

                md-menu-item.selected-home-location{
            background-color: var(--Secondary-Container);
            color: var(--On-Secondary-Container);
            pointer-events: none;

        }

                .mainTempItem.selectedMainTemp {
            background-color: var(--Secondary-Container);
            color: var(--On-Secondary-Container);
            pointer-events: none;
        }

        #apiKeyEnterInputTile {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height .6s cubic-bezier(1, 0, 0, 1), opacity .7s ease-in-out;
        }

                .main_provider_item {
            font-size: 16px;
            font-family: var(--google-mid);
            display: flex;
            align-items: center;
            gap: 10px;
            padding-top: 13px;
            padding-bottom: 13px;
        }

        .main_provider_item:first-child {
            padding-top: 5px;
        }

            .list_one md-list-item, .list_second md-list-item, .list_third md-list-item{
            background-color: var(--Surface-Container-Lowest);
            margin-bottom: 6px;
            border-radius: 8px;
        }


        .list_second md-list-item:nth-child(1), .list_third md-list-item:nth-child(1){
            border-radius: 16px 16px 8px 8px;
        }

        .list_one md-list-item:nth-child(2){
            border-radius: 16px 16px 8px 8px;
        }

        .list_one md-list-item:last-child, .list_third md-list-item:last-child{
            border-radius: 8px 8px 16px 16px ;
        }

        .list_second md-list-item:nth-last-child(2){
            border-radius: 8px 8px 16px 16px ;
        }

        md-list{
            padding: 10px;
        }

        .custom_theme .color-item{
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--clr);
            border-radius: 50px;
            flex-shrink: 0;
        }

        .custom_theme .color-item::before{
            content: 'check';
            font-family: 'Material symbols';
            font-weight: normal !important;
            font-style: normal !important;
            line-height: 1;
            font-size: 24px;
            color: var(--clr-check);
            display: var(--display-style, none);
        }

        .custom_theme{
            display: flex;
            overflow: auto;
            gap: 10px;
        }

        .custom_theme_items.hidden{
            height: 0px;
            padding: 0;
            margin: 0;
            opacity: 0;
        }

        .custom_theme_items{
            opacity: 1;
            height: 79px;
            overflow: hidden;
        }
      load_theme{
          z-index: 9909999;
          width: 100%;
          height: 100%;
          background-color: var(--Surface);
          position: fixed;
          left: 0;
          top: 0;
      }
    </style>
</head>

<body hidden>

<div class="activity-large open">
  <div class="header-activity-large" id="head-1">
    <button class="ripple-icon-btn regular" ontouchstart="playEffect(this)" ontouchend="playEffect2(this)"
            title="Go back" onclick="ActivityBack()">
      <span class="ripple-effect-icon"></span>
      <span icon-outlined>arrow_back</span>
    </button>
    <p class="label-hidden-large" style="white-space: nowrap;" data-translate="settings">Settings</p>
  </div>
  <div class="activity-large-content" id="headUser-1">
    <p class="label-large-main" data-translate="settings">Settings</p>
    <div class="content-parent-large" style="padding-bottom: 32px;">

      <p class="title" style="margin-top: 5px;" data-translate="app_looks">App looks</p>

      <md-list class="list_third">
        <md-list-item>
          <md-icon icon-filled slot="start">palette</md-icon>
          <div slot="headline" data-translate="dynamic_colors">Dynamic colors</div>
          <div slot="supporting-text" data-translate="dynamic_colors_sub">Use wallpaper colors</div>
          <md-switch slot="end" selected id="useDynamicColors"></md-switch>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">contrast</md-icon>
          <div slot="headline">Light theme</div>
          <div slot="supporting-text">BETA</div>
          <md-switch slot="end" id="useLightThemeSwitch"></md-switch>
        </md-list-item>

        <md-list-item class="custom_theme_items hidden">
          <md-icon icon-filled slot="start"></md-icon>
          <div class="custom_theme_wrap" slot="headline">
            <div class="custom_theme">
              <div class="color-item" style="--clr:  #2196f3; --clr-check: rgb(255, 255, 255);" theme-value="blue_material"></div>
              <div class="color-item" style="--clr: #673ab7; --clr-check: rgb(255, 255, 255);" theme-value="purple_material"></div>
              <div class="color-item" style="--clr: #ffeb3b; --clr-check: rgb(0, 0, 0);" theme-value="yellow_material"></div>
              <div class="color-item" style="--clr:  #4caf50; --clr-check: rgb(255, 255, 255);" theme-value="green_material"></div>
              <div class="color-item" style="--clr: #e92315; --clr-check: rgb(255, 255, 255);"  theme-value="red_material"></div>
              <div class="color-item" style="--clr: #e91e63; --clr-check: rgb(255, 255, 255);"  theme-value="pink_material"></div>
              <div class="color-item" style="--clr:  #da7e07; --clr-check: rgb(255, 255, 255);"theme-value="orange_material"></div>
              <div class="color-item" style="--clr:  #414141; --clr-check: rgb(255, 255, 255);" theme-value="mono_material"></div>

            </div>
          </div>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">thermometer_add</md-icon>
          <div slot="headline" data-translate="temperature_animation">Temperature animation</div>
          <div slot="supporting-text" data-translate="temp_animation_sub_pref">Counts the temperature from start to end</div>
          <md-switch slot="end" id="useTempAnimation" selected ></md-switch>
        </md-list-item>


        <md-list-item onclick="openAppFontDialog()" type="button">
          <md-icon icon-filled slot="start">font_download</md-icon>
          <div slot="headline" data-translate="font">Font</div>
          <div slot="supporting-text" data-translate="change_apps_font">Change app's font</div>
        </md-list-item>

        <md-list-item onclick="openAppFontSizeDialog()" type="button">
          <md-icon icon-filled slot="start">format_size</md-icon>
          <div slot="headline"data-translate="font_size">Font size</div>
          <div slot="supporting-text" data-translate="font_size_sub">Font size will only affect where it is needed</div>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">swipe_left</md-icon>
          <div slot="headline" data-translate="swipe_between_locations">Swipe between locations</div>
          <div slot="supporting-text" data-translate="swipe_between_locations_sub">Swipe left or right to change location</div>
          <md-switch slot="end" id="useGestureLocation"></md-switch>
          <md-icon-button slot="end" onclick="openSwipeThresholdDialog()"><md-icon icon-outlined>settings</md-icon></md-icon-button>
        </md-list-item>

        <md-list-item onclick="navigateActivity('EditAppLayoutPage')" type="button">
          <md-icon icon-filled slot="start">view_agenda</md-icon>
          <div slot="headline" data-translate="edit_layout">Edit app layout</div>
          <md-icon icon-filled slot="end">chevron_right</md-icon>
        </md-list-item>

      </md-list>


      <p class="title" style="margin-top: 5px;" data-translate="weather">Weather</p>



      <md-list class="list_one">


        <md-list-item disabled hidden>
          <md-icon icon-filled slot="start">notifications</md-icon>
          <div slot="headline" data-translate="notification_bar">Notification bar</div>
          <div slot="supporting-text" data-translate="show_weather_information_in_the_notification_bar">(Needs some work done)</div>
          <md-switch slot="end" id="toggle_noti"></md-switch>
        </md-list-item>

        <md-list-item type="button" onclick="navigateActivity('openHomelocationPage')">
          <md-icon icon-filled slot="start">home_pin</md-icon>
          <div slot="headline" data-translate="home_location">Home location</div>
          <div slot="supporting-text" id="homeLocationSelectedText" style="color: var(--Primary); font-family: var(--outfit-mid);">Your device location</div>

          <md-icon slot="end" icon-outlined>chevron_right</md-icon>

        </md-list-item>

        <md-list-item type="button" onclick="navigateActivity('AppUnitsActivity')">
          <md-icon icon-filled slot="start">thermostat</md-icon>
          <div slot="headline" data-translate="app_units">App units</div>
          <div slot="supporting-text" data-translate="temperature_wind_pressure_visibility_precipitation_time_aqi">Temperature, wind, pressure, visibility, precipitation, time, AQI</div>
          <md-icon slot="end" icon-outlined>chevron_right</md-icon>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">animation</md-icon>
          <div slot="headline" data-translate="background_card_animation">Background card animation</div>
          <md-switch slot="end" selected id="useAnimationBackground"></md-switch>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">update</md-icon>
          <div slot="headline" data-translate="update_weather_data">Update weather data</div>
          <div slot="supporting-text" data-translate="update_weather_data_sub">Automatically update the weather data if it's outdated when a location is clicked</div>
          <md-switch slot="end" id="autoUpdateOldWeather"></md-switch>
        </md-list-item>

        <md-list-item id="froggy_summary_item">
          <md-icon icon-filled slot="start">summarize</md-icon>
          <div slot="headline" data-translate="froggy_summary">Froggy summary</div>
          <div slot="supporting-text" data-translate="froggy_summary_sub">Adds frog-related descriptions. Available only in English</div>
          <md-switch slot="end" id="useFroggySummarySwitch"></md-switch>
        </md-list-item>


        <md-list-item>
          <md-icon icon-filled slot="start">summarize</md-icon>
          <div slot="headline" data-translate="quick_summary">Quick summary</div>
          <div slot="supporting-text" data-translate="show_summary_toggle_sub">Show a brief summary of the weather</div>
          <md-switch slot="end" id="useQuickSummarySwitch" selected></md-switch>
        </md-list-item>


        <md-list-item>
          <md-icon icon-filled slot="start">notifications_unread</md-icon>
          <div slot="headline" data-translate="hide_update_icon">Hide update icon</div>
          <div slot="supporting-text" data-translate="no_notification_when_a_new_version_is_released">Don't show a notification when a new version is released.</div>
          <md-switch slot="end" id="HideNewUpdateToastSwitch"></md-switch>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">bar_chart</md-icon>
          <div slot="headline" data-translate="use_bar_chart">Use bar chart</div>
          <md-switch slot="end" id="useBarChart"></md-switch>
        </md-list-item>

        <md-list-item>
          <md-icon icon-filled slot="start">warning</md-icon>
          <div slot="headline" data-translate="weather_alerts">Weather alerts</div>
          <div slot="supporting-text" data-translate="show_alerts_home_page_sub">Show weather alerts on the home page</div>
          <md-switch slot="end" id="useWeatherAlerts"></md-switch>
        </md-list-item>

        <md-list-item type="button" onclick="openMainProviderDialog()">
          <md-icon slot="start" icon-filled>routine</md-icon>
          <div slot="headline" data-translate="main_provider">Main provider</div>
          <div slot="supporting-text" id="mainProviderSelectedText"
               style="color: var(--Primary); font-family: var(--outfit-mid);">Open-meteo</div>
        </md-list-item>

        <md-list-item margin type="button" onclick="navigateActivity('openWeatherModels')" id="weatherModelBtn">
          <md-icon icon-filled slot="start"></md-icon>
          <div slot="headline" data-translate="weather_models">Weather models</div>
          <div slot="supporting-text" data-translate="openmeteo_weather_models">Open-Meteo Weather models</div>
          <md-icon slot="end" icon-outlined>chevron_right</md-icon>
        </md-list-item>

        <md-list-item style="overflow: hidden; max-height: 0; transition: max-height 0.3s ease-out, opacity 0.8s ease-out" id="accuweatherAPI_input_item">
          <md-filled-tonal-icon-button slot="start" onclick="verifyKeyAccu()"><md-icon icon-outlined>check</md-icon></md-filled-tonal-icon-button>
          <div slot="headline">
            <md-outlined-text-field placeholder="Accuweather API" id="input_accuweather_field" supporting-text="Only developer free keys are supported"></md-outlined-text-field>
          </div>
        </md-list-item>

        <md-list-item hidden>
          <md-icon slot="start" icon-filled>warning</md-icon>
          <div slot="headline">Alerts</div>
          <div slot="supporting-text">Alerts provider</div>
          <md-outlined-select slot="end" style="min-width: max-content; --md-outlined-field-bottom-space: 10px;--md-outlined-field-top-space: 10px;" id="selectMainAlertsProvider">
            <md-select-option  value="weatherapi-alert" menu-type>
              <div slot="headline">weatherapi</div>
            </md-select-option>
            <md-select-option value="OpenWeather-alert" menu-type>
              <div slot="headline">OpenWeather</div>
            </md-select-option>
            <md-select-option value="Accuweather-alert" menu-type>
              <div slot="headline">Accuweather</div>
            </md-select-option>
          </md-outlined-select>
        </md-list-item>

        <md-list-item hidden>
          <md-icon slot="start" icon-filled>search</md-icon>
          <div slot="headline">Search</div>
          <div slot="supporting-text">Search provider</div>

          <md-outlined-select slot="end" style="min-width: max-content; --md-outlined-field-bottom-space: 10px;--md-outlined-field-top-space: 10px;" id="selectMainSearchProvider">
            <md-select-option  value="open-meteo-search" menu-type>
              <div slot="headline">open-meteo</div>
            </md-select-option>
            <md-select-option value="weatherapi-search" menu-type>
              <div slot="headline">weatherapi</div>
            </md-select-option>
          </md-outlined-select>
        </md-list-item>

      </md-list>

      <p class="title" style="margin-top: 5px;" data-translate="additional">Additional</p>
      <md-list class="list_second">

        <md-list-item margin type="button" onclick="navigateActivity('OpenLanguagesPage')">
          <md-icon slot="start" icon-filled>language</md-icon>
          <div slot="headline" data-translate="app_language">App language</div>
          <div slot="supporting-text" id="selectedAppLang_text">English</div>
        </md-list-item>

        <md-list-item  onclick="navigateActivity('OpenAboutPage')" type="button">
          <md-icon icon-filled slot="start">info</md-icon>
          <div slot="headline"><span data-translate="about">About</span> WeatherMaster</div>
          <div slot="supporting-text" data-translate="learn_about_app">Learn about the app</div>
          <md-icon icon-outlined slot="end">chevron_right</md-icon>
        </md-list-item>

        <md-list-item  href="https://discord.gg/sSW2E4nqmn" type="button" draggable="false">
          <md-icon icon-filled slot="start">chat</md-icon>
          <div slot="headline" data-translate="join_discord">Join the Discord server</div>
          <md-icon icon-outlined slot="end">open_in_new</md-icon>
        </md-list-item>

        <md-list-item type="button" id="exportAppData">
          <md-icon icon-filled slot="start">upload</md-icon>
          <div slot="headline" data-translate="export_data">Export data</div>
          <div slot="supporting-text" data-translate="export_data_sub">Export all your settings, locations, and their last fetched weather data—literally everything!</div>
        </md-list-item>


        <md-list-item type="button" id="importAppData">
          <md-icon icon-filled slot="start">download</md-icon>
          <div slot="headline" data-translate="import_data">Import data</div>
          <div slot="supporting-text" style="color: var(--Error);" data-translate="import_data_sub">Warning: Importing will erase your current app data</div>
        </md-list-item>
        <input type="file" id="ImportFile" style="display:none;" accept="application/json">
      </md-list>


      <p class="title" style="margin-top: 5px;" data-translate="data_provided_by">Data provided by</p>
      <md-list class="list_third">
        <md-list-item margin href="https://www.geonames.org/" draggable="false">
          <div slot="headline">GeoNames</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
        <md-list-item margin href="https://nominatim.org/" draggable="false">
          <div slot="headline">Nominatim</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
        <md-list-item margin href="https://open-meteo.com/" draggable="false">
          <div slot="headline">Open-Meteo</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
      </md-list>



      <p class="title" style="margin-top: 5px;" data-translate="map">Map</p>
      <md-list class="list_third">
        <md-list-item margin href="https://leafletjs.com/" draggable="false">
          <div slot="headline">Leaflet</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
        <md-list-item margin href="https://www.rainviewer.com/" draggable="false">
          <div slot="headline">Rainviewer</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
        <md-list-item margin href="https://www.openstreetmap.org/" draggable="false">
          <div slot="headline">OpenStreetMap</div>
          <md-icon icon-filled slot="end">open_in_new</md-icon>
        </md-list-item>
      </md-list>

      <md-dialog id="chooseMainProviderDialog" style="min-width: 85%;">
        <div slot="headline" data-translate="main_provider">
          Main provider
        </div>

        <div slot="content">

          <label class="main_provider_item">
            <md-radio slot="start" value="open-meteo" name="main_provider_radio"></md-radio>
            Open-Meteo (Global)
          </label>
          <label class="main_provider_item" style="position: relative; padding-bottom: 20px;">
            <md-radio slot="start" value="Accuweather" name="main_provider_radio"></md-radio>
            Accuweather (Global)
            <span style="color: var(--On-Surface-Variant);position: absolute;left: 30px;bottom: 0;font-size: 12px;">API required</span>
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="Met norway" name="main_provider_radio"></md-radio>
            Met Norway (Global)
          </label>
          <!-- New weather providers -->
          <label class="main_provider_item">
            <md-radio slot="start" value="dwdGermany" name="main_provider_radio"></md-radio>
            DWD (Europe, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="noaaUS" name="main_provider_radio"></md-radio>
            NOAA (Americas, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="meteoFrance" name="main_provider_radio"></md-radio>
            Météo-France (Europe, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="ecmwf" name="main_provider_radio"></md-radio>
            ECMWF (Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="ukMetOffice" name="main_provider_radio"></md-radio>
            UK Met Office (Europe, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="jmaJapan" name="main_provider_radio"></md-radio>
            JMA (Asia, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="gemCanada" name="main_provider_radio"></md-radio>
            GEM (Americas, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="bomAustralia" name="main_provider_radio"></md-radio>
            BOM (Oceania, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="cmaChina" name="main_provider_radio"></md-radio>
            CMA (Asia, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="knmiNetherlands" name="main_provider_radio"></md-radio>
            KNMI (Europe, Global)
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="dmiDenmark" name="main_provider_radio"></md-radio>
            DMI (Europe, Global)
          </label>
        </div>

        <div slot="actions">
          <md-text-button onclick="window.history.back()" data-translate="cancel">Cancel</md-text-button>
          <md-text-button id="saveSelectedMainProvider" data-translate="save">Save</md-text-button>
        </div>
      </md-dialog>


      <md-dialog id="chooseAPPFontDialog" style="min-width: 85%;">
        <div slot="headline" data-translate="app_font">App font</div>

        <div slot="content">
          <label class="main_provider_item">
            <md-radio slot="start" value="product_sans" name="app_font_radio"></md-radio>
            Product sans
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="roboto" name="app_font_radio"></md-radio>
            Roboto
          </label>
        </div>

        <div slot="actions">
          <md-text-button onclick="window.history.back()" data-translate="cancel">Cancel</md-text-button>
          <md-text-button id="saveSelectedFont" data-translate="ok">OK</md-text-button>
        </div>
      </md-dialog>

      <md-dialog id="chooseAPPFontSizeDialog" style="min-width: 85%;" quick>
        <div slot="headline" data-translate="font_size">App font size</div>

        <div slot="content">
          <label class="main_provider_item">
            <md-radio slot="start" value="normal_fontSize" name="app_font_size_radio"></md-radio>
            Normal
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="medium_fontSize" name="app_font_size_radio"></md-radio>
            Medium
          </label>
          <label class="main_provider_item">
            <md-radio slot="start" value="large_fontSize" name="app_font_size_radio"></md-radio>
            Large
          </label>
        </div>

        <div slot="actions">
          <md-text-button onclick="window.history.back()" data-translate="cancel">Cancel</md-text-button>
          <md-text-button id="saveSelectedFontSize" data-translate="save">Save</md-text-button>
        </div>
      </md-dialog>

      <md-dialog id="chooseSwipeThresholdDialog" style="min-width: 85%;">
                <span slot="headline">
                    <span style="flex: 1;" data-translate="swipe_threshold">Swipe Threshold</span>
                    <div slot="supporting-text" id="ThresholdValueText" style="font-size: 15px; right: 20px; color: var(--On-Surface-Variant); width: 35px; height: 30px; background-color: var(--Primary-Container); display: flex; align-items: center; justify-content: center; border-radius: 50px; padding: 2px; color: var(--On-Primary-Container); font-family: var(--google-mid);">100</div>
                  </span>

        <div slot="content" style="padding-left: 0; padding-right: 0;">
          <md-slider style="width: 100%;" ticks min="50" max="350" value="100"  step="50" id="ThresholdSlider"></md-slider>

          <p style="margin-bottom: 0; margin-left: 15px; margin-right: 15px; margin-top: 0;" data-translate="swipe_threshold_help_sub">The threshold defines the minimum distance a swipe gesture must cover to be recognized. A lower threshold makes swipe gestures easier to trigger, while a higher threshold requires more deliberate swipes.</p>
        </div>
      </md-dialog>


      <p style="margin-top: 110px;"></p>



    </div>
  </div>
</div>




<!-- theme-overlay -->
<div class="theme_overlay" hidden>
  <md-circular-progress id="theme_loader"></md-circular-progress>
</div>

<load_theme hidden></load_theme>


<script>

function hexToRgb(hex) {
    const bigint = parseInt(hex.slice(1), 16);
    return {
        r: (bigint >> 16) & 255,
        g: (bigint >> 8) & 255,
        b: bigint & 255
    };
}


function rgbToHsl({ r, g, b }) {
    r /= 255;
    g /= 255;
    b /= 255;

    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;

    if (max === min) {
        h = s = 0; // Achromatic
    } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }

    return { h: h * 360, s: s * 100, l: l * 100 };
}

async function CreateMaterialYouTheme(hex) {
    const colors = {
        orange_material: "#FFA500",
        red_material: "#FF0000",
        pink_material: "#FFC0CB",
        purple_material: "#800080",
        blue_material: "#0000FF",
        yellow_material: "#FFFF00",
        green_material: "#008000",
        mono_material: "#e2e2e2"
    };



    const targetHsl = rgbToHsl(hexToRgb(hex));
    let closestColor = null;
    let smallestHueDifference = Infinity;

    for (const [color, colorHex] of Object.entries(colors)) {
        const colorHsl = rgbToHsl(hexToRgb(colorHex));
        const hueDifference = Math.abs(targetHsl.h - colorHsl.h);
        if (targetHsl.s < 10) {
            closestColor = "mono_material";
            break;
        }
        if (hueDifference < smallestHueDifference) {
            smallestHueDifference = hueDifference;
            closestColor = color;
        }

}

 if(localStorage.getItem("useDynamicColors") && localStorage.getItem("useDynamicColors") === "false"){

      if (await customStorage.getItem("customTheme")) {
    document.documentElement.setAttribute(
      "Theme",
      await customStorage.getItem("customTheme")
    );
  } else{
    document.documentElement.setAttribute(
     "Theme",
        "blue_material"
   );
     await customStorage.setItem("customTheme", "blue_material");
  }

      if(localStorage.getItem('useLightTheme') && localStorage.getItem('useLightTheme') === 'true'){
        document.documentElement.setAttribute('colorTheme', 'light');
        sendThemeToAndroid(getComputedStyle(document.documentElement).getPropertyValue('--Surface'), getComputedStyle(document.documentElement).getPropertyValue('--Surface'), '1')

      } else{
        document.documentElement.setAttribute('colorTheme', 'dark');
        sendThemeToAndroid(getComputedStyle(document.documentElement).getPropertyValue('--Surface'), getComputedStyle(document.documentElement).getPropertyValue('--Surface'), '0')
      }
        document.querySelector('body').hidden = false
  } else{
        document.documentElement.setAttribute('Theme', closestColor);

      if(localStorage.getItem('useLightTheme') && localStorage.getItem('useLightTheme') === 'true'){
        document.documentElement.setAttribute('colorTheme', 'light');
        sendThemeToAndroid(getComputedStyle(document.documentElement).getPropertyValue('--Surface'), getComputedStyle(document.documentElement).getPropertyValue('--Surface'), '1')

      } else{
        document.documentElement.setAttribute('colorTheme', 'dark');
        sendThemeToAndroid(getComputedStyle(document.documentElement).getPropertyValue('--Surface'), getComputedStyle(document.documentElement).getPropertyValue('--Surface'), '0')
      }
        document.querySelector('body').hidden = false
  }
}

    </script>
</script>

<script src="../modules/settingsModule.js"></script>
<script src="../components-script.js/components.js"></script>
<script src="../ripple-files/icon-ripple.js"></script>
<script src="../modules/scroll.js"></script>
<script src="../modules/ripple_acc.js"></script>
<script src="../app/navigate.js"></script>
<script type="module" src="../index.js"></script>
<script src="../modules/weather-sources.js"></script>

</body>

</html>